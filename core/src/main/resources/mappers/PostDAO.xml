<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nagesoft.postcode.dao.PostDAO">
    <resultMap id="buildingInfoResult" type="com.nagesoft.postcode.model.BuildingInfo">

    </resultMap>
    <insert id="insertBuildingInfo" parameterType="buildingInfo">
      INSERT INTO POST_BD_INFO(
        BD_SEQ
        ,LEGAL_DONG_CD
        ,SIDO_NM
        ,SIGUNGU_NM
        ,LEGAL_DONG_NM
        ,LEGAL_RI_NM
        ,SAN_YN
        ,LOT_BASIC_NUM
        ,LOT_PART_NUM
        ,ROAD_CD
        ,ROAD_NM
        ,UNDER_YN
        ,BD_BASIC_NUM
        ,BD_PART_NUM
        ,POST_CD
        ,SIGUNGU_BD_NM
        ,JOINT_YN
      ) VALUES (
        #{buildingSeq,jdbcType=VARCHAR}
        ,#{legalDongCode,jdbcType=VARCHAR}
        ,#{sidoName,jdbcType=VARCHAR}
        ,#{sigunguName,jdbcType=VARCHAR}
        ,#{legalDongName,jdbcType=VARCHAR}
        ,#{legalRiName,jdbcType=VARCHAR}
        ,#{sanYN}
        ,#{lotBasicNumber}
        ,#{lotPartNumber}
        ,#{roadCode,jdbcType=VARCHAR}
        ,#{roadName,jdbcType=VARCHAR}
        ,#{underYN}
        ,#{buildingBasicNumber}
        ,#{buildingPartNumber}
        ,#{postCode,jdbcType=VARCHAR}
        ,#{sigunguBuildingName,jdbcType=VARCHAR}
        ,#{jointYN}
      )
    </insert>

    <insert id="insertRefLot" parameterType="buildingInfo">
      INSERT INTO POST_REF_LOT(
        ROAD_CD
        ,UNDER_YN
        ,BD_BASIC_NUM
        ,BD_PART_NUM
        ,LOT_SEQ
        ,LEGAL_DONG_CD
        ,SIDO_NM
        ,SIGUNGU_NM
        ,LEGAL_DONG_NM
        ,LEGAL_RI_NM
        ,SAN_YN
        ,LOT_BASIC_NUM
        ,LOT_PART_NUM
      ) VALUES (
         #{roadCode,jdbcType=VARCHAR}
        ,#{underYN}
        ,#{buildingBasicNumber}
        ,#{buildingPartNumber}
        ,#{lotSeq}
        ,#{legalDongCode}
        ,#{sidoName,jdbcType=VARCHAR}
        ,#{sigunguName,jdbcType=VARCHAR}
        ,#{legalDongName,jdbcType=VARCHAR}
        ,#{legalRiName,jdbcType=VARCHAR}
        ,#{sanYN}
        ,#{lotBasicNumber}
        ,#{lotPartNumber}
      )
    </insert>
    <select id="getList" resultType="buildingInfo">
        SELECT
        BD.BD_SEQ
        ,BD.LEGAL_DONG_CD
        ,BD.SIDO_NM
        ,BD.SIGUNGU_NM
        ,BD.LEGAL_DONG_NM
        ,BD.LEGAL_RI_NM
        ,BD.SAN_YN
        ,BD.LOT_BASIC_NUM
        ,BD.LOT_PART_NUM
        ,BD.ROAD_CD
        ,BD.ROAD_NM
        ,BD.UNDER_YN
        ,BD.BD_BASIC_NUM
        ,BD.BD_PART_NUM
        ,BD.POST_CD
        ,BD.SIGUNGU_BD_NM
        ,BD.JOINT_YN
        ,LOT.ROAD_CD AS LOT_ROAD_CD
        ,LOT.LEGAL_DONG_CD AS LOT_LEGAL_DONG_C
        ,LOT.SIDO_NM AS LOT_SIDO_NM
        ,LOT.SIGUNGU_NM AS LOT_SIGUNGU_NM
        ,LOT.LEGAL_DONG_NM AS LOT_LEGAL_DONG_N
        ,LOT.LEGAL_RI_NM AS LOT_LEGAL_RI_NM
        ,LOT.SAN_YN AS LOT_SAN_YN
        ,LOT.LOT_BASIC_NUM AS LOT_LOT_BASIC_NU
        ,LOT.LOT_PART_NUM AS LOT_LOT_PART_NUM
        ,LOT.UNDER_YN AS LOT_UNDER_YN
        ,LOT.BD_BASIC_NUM AS LOT_BD_BASIC_NUM
        ,LOT.BD_PART_NUM AS LOT_BD_PART_NUM
        FROM POST_BD_INFO BD
        LEFT OUTER JOIN POST_REF_LOT LOT
        ON BD.ROAD_CD = LOT.ROAD_CD
        AND BD.UNDER_YN = LOT.UNDER_YN
        AND BD.BD_BASIC_NUM = LOT.BD_BASIC_NUM
        AND BD.BD_PART_NUM = LOT.BD_PART_NUM
    </select>
</mapper>