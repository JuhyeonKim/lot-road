function resetForm(e){var o=$("#addCodeForm");$(o).find("#code").remove(),$("#codeName").val("").focus(),$("#codeAlias").val(""),$("#description").val(""),$("#useYNN").iCheck("check"),$("#parentCode").val(""),$("#sortOrder").val(""),$("#parentCodeName").val(""),$("#addNewSubCode").addClass("disabled"),$("#saveCodeButton").text("등록"),$("input[name='_method']").remove(),e&&$("#codeTree").find("li").removeAttr("style").removeClass("node-selected")}function getCodeData(e){var o=$("#addCodeForm");$(o).find("#code").remove(),$("#parentCodeName").prop("disabled",!0).val(""),$("#codeName").val(e.text),$("#description").val(e.description),$("#codeAlias").val(e.alias),$("#sortOrder").val(e.sortOrder),$(o).append("<input type='hidden' name='code' id='code' value='"+e.code+"' />"),"Y"===e.useYN?$("#useYNY").iCheck("check"):$("#useYNN").iCheck("check"),""!==e.parentCode&&($("#parentCode").val(e.parentCode),$("#parentCodeName").val(e.parentCodeName),$("#sortOrder").prop("disabled",!1)),$("#addNewSubCode").removeClass("disabled"),$("#saveCodeButton").text("수정"),$(o).append('<input type="hidden" name="_method" value="put" />')}function makeSubNodeData(e,o){if(void 0!==o&&void 0!==o.childList&&null!==o.childList&&o.childList.length>0){e.icon="-",(null===e.nodes||void 0===e.nodes)&&(e.nodes=[]);for(var a=o.childList,d=a.length,t=0;d>t;t++){var n=a[t],r={text:n.name,code:n.code,alias:n.alias,sortOrder:n.sortOrder,parentCode:n.parentCode,parentCodeName:n.parentCodeName,useYN:n.useYN,description:n.description};makeSubNodeData(r,n),e.nodes.push(r)}}else e.icon="fa fa-angle-double-right"}function makeNodeData(e,o){var a={text:o.name,code:o.code,alias:o.alias,sortOrder:o.sortOrder,parentCode:null!==o.parentCode&&void 0!==o.parentCode?o.parentCode:"",parentCodeName:null!==o.parentCodeName&&void 0!==o.parentCodeName?o.parentCodeName:"",useYN:o.useYN,description:o.description};makeSubNodeData(a,o),e.push(a)}function getCodeList(){$.ajax({type:"get",url:ctx+"/system/code/list?ajax=true",dataType:"json",success:function(e){if("y"===e.result){for(var o=e.list,a=o.length,d=[],t=0;a>t;t++){var n=o[t];makeNodeData(d,n)}var r={data:d,expandIcon:"fa fa-folder",collapseIcon:"fa fa-folder-open",levels:1};$("#codeTree").treeview(r).on("nodeSelected",function(e,o){getCodeData(o)}),$("#codeTree").find("li").each(function(){$(this).html("<div>"+$(this).html()+"</div>")})}else void 0!==e.message&&null!==e.message&&$("#ajaxModal").modal()}})}function saveCode(){var e=$("#addCodeForm").serialize(),o=ctx+"/system/code/form";$("input[name='_method']").length>0&&(o=ctx+"/system/code/"+$("#code").val()+"/form"),$.ajax({type:"post",url:o,data:e,dataType:"json",success:function(e){if("y"===e.result)$("#codeTree").empty(),resetForm(!0),getCodeList(),showGrowlMessage("처리되었습니다.");else{var o=null!==e.message&&void 0!==e.message?e.message:"서버에서 오류가 발생하였습니다.";"[object Array]"===Object.prototype.toString.call(o)?displayErrorMessage(o,"#addCodeForm"):(console.log(o),$(".modal-body").html("<p>"+o+"</p>"),$("#ajaxModal").modal())}}})}function setAddSubCode(){var e=$("#code").val(),o=$(".node-selected").text();resetForm(!1),$("#parentCode").val(e),$("#parentCodeName").val(o),$("#codeName").focus()}$(document).ready(function(){$(".modal-footer").find("button").on("click",function(){$("#ajaxModal").modal("hide")}),$("#codeName").focus(),$("#saveCodeButton").on("click",function(e){saveCode(),e.preventDefault()}),$("#addNewCode").on("click",function(e){resetForm(!0),$("#sortOrder").prop("disabled",!0),e.preventDefault()}),$("#addNewSubCode").on("click",function(e){setAddSubCode(),$("#sortOrder").prop("disabled",!1),e.preventDefault()}),$("#cancelCodeButton").on("click",function(e){resetForm(!0),e.preventDefault()}),getCodeList()});